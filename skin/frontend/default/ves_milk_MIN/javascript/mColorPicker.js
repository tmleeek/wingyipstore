!function(r){var o,e,t,c,a="<div>",n="<img>",i="<span>",l=r(document),s=r(a),d=r(a),f=r(a),p=r("<input>"),u=/^rgb[a]?\((\d+),\s*(\d+),\s*(\d+)(,\s*(\d+\.\d+)*)?\)/,m=/([a-f0-9])([a-f0-9])([a-f0-9])/,h=/#[a-f0-9]{3}/,C=/#[a-f0-9]{6}/;r.fn.mColorPicker=function(t){var c=r.fn.mColorPicker.getCookie("swatches");return o=r.extend(r.fn.mColorPicker.defaults,t),r.fn.mColorPicker.defaults.swatches.concat(o.swatches).slice(-10),e.enhancedSwatches&&c&&(o.swatches=c.split("||").concat(o.swatches).slice(0,10)||o.swatches),r("div#mColorPicker").length||r.fn.mColorPicker.drawPicker(),r("#css_disabled_color_picker").length||r("head").prepend('<meta data-remove-me="true"/><style id="css_disabled_color_picker" type="text/css">.mColorPicker[disabled] + span, .mColorPicker[disabled="disabled"] + span, .mColorPicker[disabled="true"] + span {filter:alpha(opacity=50);-moz-opacity:0.5;-webkit-opacity:0.5;-khtml-opacity: 0.5;opacity: 0.5;cursor:default;}</style>'),r("meta[data-remove-me=true]").remove(),this.each(r.fn.mColorPicker.drawPickerTriggers),this},r.fn.mColorPicker.init={replace:"[type=color]",index:0,enhancedSwatches:!0,allowTransparency:!0,slogan:"Meta100 - Designing Fun",showLogo:!0},r.fn.mColorPicker.defaults={currentId:!1,currentInput:!1,currentColor:!1,changeColor:!1,color:!1,imageFolder:"undefined"==typeof $pavColorImageFolder?"images/":$pavColorImageFolder,swatches:["#ffffff","#ffff00","#00ff00","#00ffff","#0000ff","#ff00ff","#ff0000","#4c2b11","#3b3b3b","#000000"]},r.fn.mColorPicker.start=function(){r('input[data-mcolorpicker!="true"]').filter(function(){return"[type=color]"==e.replace?"color"==this.getAttribute("type"):r(this).is(e.replace)}).mColorPicker()},r.fn.mColorPicker.events=function(){r("#mColorPickerBg").live("click",r.fn.mColorPicker.closePicker),r(".mColorPicker").live("keyup",function(){try{r(this).css({"background-color":r(this).val()}).css({color:r.fn.mColorPicker.textColor(r(this).css("background-color"))}).trigger("change")}catch(o){}}),r(".mColorPickerTrigger").live("click",r.fn.mColorPicker.colorShow),r(".mColor, .mPastColor").live("mousemove",function(e){if(!o.changeColor)return!1;var t=r(this),c=t.offset(),a=o.currentInput,n=a.attr("data-hex")||a.attr("hex");o.color=t.css("background-color"),t.hasClass("mPastColor")?o.color=r.fn.mColorPicker.setColor(o.color,n):t.hasClass("mColorTransparent")?o.color="transparent":t.hasClass("mPastColor")||(o.color=r.fn.mColorPicker.whichColor(e.pageX-c.left,e.pageY-c.top,n)),o.currentInput.mSetInputColor(o.color)}).live("click",r.fn.mColorPicker.colorPicked),r("#mColorPickerInput").live("keyup",function(e){try{o.color=r(this).val(),o.currentInput.mSetInputColor(o.color),13==e.which&&r.fn.mColorPicker.colorPicked()}catch(t){}}).live("blur",function(){o.currentInput.mSetInputColor(o.color)}),r("#mColorPickerWrapper").live("mouseleave",function(){if(!o.changeColor)return!1;var e=o.currentInput;o.currentInput.mSetInputColor(r.fn.mColorPicker.setColor(o.currentColor,e.attr("data-hex")||e.attr("hex")))})},r.fn.mColorPicker.drawPickerTriggers=function(){var t,a=r(this),l=a.attr("id")||"color_"+e.index++,s="hidden"==a.attr("text")||"hidden"==a.attr("data-text")?!0:!1,d=r.fn.mColorPicker.setColor(a.val(),a.attr("data-hex")||a.attr("hex")),f=a.width(),p=a.height(),u=a.css("float"),m=r(i),h=r(i),C="";return m.attr({id:"color_work_area","class":"mColorPickerInput"}).appendTo(c),h.attr({id:"mcp_"+l,"class":"mColorPickerTrigger"}).css({display:"inline-block",cursor:"pointer"}).insertAfter(a),r(n).attr({src:o.imageFolder+"color.png"}).css({border:0,margin:"0 0 0 3px","vertical-align":"text-bottom"}).appendTo(h),m.append(a),C=m.html().replace(/type=[^a-z ]*color[^a-z //>]*/gi,'type="'+(s?"hidden":"text")+'"'),m.html("").remove(),t=r(C).attr("id",l).addClass("mColorPicker").val(d).insertBefore(h),s&&h.css({border:"1px solid black","float":u,width:f,height:p}).addClass(t.attr("class")).html("&nbsp;"),t.mSetInputColor(d),t},r.fn.mColorPicker.drawPicker=function(){var l=r(a),u=r("<a>"),m=r(a),h=r(a);for(d.attr({id:"mColorPickerBg"}).css({display:"none",background:"black",opacity:.01,position:"absolute",top:0,right:0,bottom:0,left:0}).appendTo(c),s.attr({id:"mColorPicker","data-mcolorpicker":!0}).css({position:"absolute",border:"1px solid #ccc",color:"#fff",width:"194px",height:"184px","font-size":"12px","font-family":"times",display:"none"}).appendTo(c),f.attr({id:"mColorPickerTest"}).css({display:"none"}).appendTo(c),h.attr({id:"mColorPickerWrapper"}).css({position:"relative",border:"solid 1px gray"}).appendTo(s),r(a).attr({id:"mColorPickerImg","class":"mColor"}).css({height:"136px",width:"192px",border:0,cursor:"crosshair","background-image":"url("+o.imageFolder+"picker.png)"}).appendTo(h),l.attr({id:"mColorPickerSwatches"}).css({"border-right":"1px solid #000"}).appendTo(h),r(a).addClass("mClear").css({clear:"both"}).appendTo(l),t=9;t>-1;t--)r(a).attr({id:"cell"+t,"class":"mPastColor"+(t>0?" mNoLeftBorder":"")}).css({"background-color":o.swatches[t].toLowerCase(),height:"18px",width:"18px",border:"1px solid #000","float":"left"}).html("&nbsp;").prependTo(l);m.attr({id:"mColorPickerFooter"}).css({"background-image":"url("+o.imageFolder+"grid.gif)",position:"relative",height:"26px"}).appendTo(h),p.attr({id:"mColorPickerInput",type:"text"}).css({border:"solid 1px gray","font-size":"10pt",margin:"3px",width:"80px"}).appendTo(m),e.allowTransparency&&r(i).attr({id:"mColorPickerTransparent","class":"mColor mColorTransparent"}).css({"font-size":"16px",color:"#000","padding-right":"30px","padding-top":"3px",cursor:"pointer",overflow:"hidden","float":"right"}).text("transparent").appendTo(m),e.showLogo&&u.attr({href:"http://meta100.com/",title:e.slogan,alt:e.slogan,target:"_blank"}).css({"float":"right"}).appendTo(m),r(n).attr({src:o.imageFolder+"meta100.png",title:e.slogan,alt:e.slogan}).css({border:0,"border-left":"1px solid #aaa",right:0,position:"absolute"}).appendTo(u),r(".mNoLeftBorder").css({"border-left":0})},r.fn.mColorPicker.closePicker=function(){d.hide(),s.fadeOut()},r.fn.mColorPicker.colorShow=function(){var e=r(this),t=e.attr("id").replace("mcp_",""),c=e.offset(),a=r("#"+t),n=c.top+e.outerHeight(),i=c.left;return a.attr("disabled")?!1:(o.currentColor=a.css("background-color"),o.changeColor=!0,o.currentInput=a,o.currentId=t,n+s.height()>l.height()&&(n=c.top-s.height()),i+s.width()>l.width()&&(i=c.left-s.width()+e.outerWidth()),s.css({top:n+"px",left:i+"px"}).fadeIn("fast"),d.show(),o.color=r("#"+t).attr("data-text")?e.css("background-color"):a.css("background-color"),o.color=r.fn.mColorPicker.setColor(o.color,a.attr("data-hex")||a.attr("hex")),void p.val(o.color))},r.fn.mColorPicker.setInputColor=function(o,e){r("#"+o).mSetInputColor(e)},r.fn.mSetInputColor=function(e){var t=r(this),c={"background-color":e,"background-image":"transparent"==e?"url('"+o.imageFolder+"grid.gif')":"",color:r.fn.mColorPicker.textColor(e)};(t.attr("data-text")||t.attr("text"))&&t.next().css(c),t.val(e).css(c).trigger("change"),p.val(e)},r.fn.mColorPicker.textColor=function(o){return o=r.fn.mColorPicker.RGBtoHex(o),"undefined"==typeof o||"transparent"==o?"black":parseInt(o.substr(1,2),16)+parseInt(o.substr(3,2),16)+parseInt(o.substr(5,2),16)<400?"white":"black"},r.fn.mColorPicker.setCookie=function(r,o,e){var t=r+"="+escape(o),c=new Date;c.setDate(c.getDate()+e),t+="; expires="+c.toGMTString(),document.cookie=t},r.fn.mColorPicker.getCookie=function(r){var o=document.cookie.match("(^|;) ?"+r+"=([^;]*)(;|$)");return o?unescape(o[2]):null},r.fn.mColorPicker.colorPicked=function(){o.changeColor=!1,r.fn.mColorPicker.closePicker(),r.fn.mColorPicker.addToSwatch(),o.currentInput.trigger("colorpicked")},r.fn.mColorPicker.addToSwatch=function(c){if(!e.enhancedSwatches)return!1;var a=[];t=0,"string"==typeof c&&(o.color=c),"transparent"!=o.color&&(a[0]=r.fn.mColorPicker.hexToRGB(o.color)),r(".mPastColor").each(function(){var e=r(this);o.color=r.fn.mColorPicker.hexToRGB(e.css("background-color")),o.color!=a[0]&&a.length<10&&(a[a.length]=o.color),e.css("background-color",a[t++])}),e.enhancedSwatches&&r.fn.mColorPicker.setCookie("swatches",a.join("||"),365)},r.fn.mColorPicker.whichColor=function(o,e,t){var c=[255,255,255];32>o?(c[1]=8*o,c[2]=0):64>o?(c[0]=256-8*(o-32),c[2]=0):96>o?(c[0]=0,c[2]=8*(o-64)):128>o?(c[0]=0,c[1]=256-8*(o-96)):160>o?(c[0]=8*(o-128),c[1]=0):(c[1]=0,c[2]=256-8*(o-160));for(var a=0;3>a;a++)64>e?c[a]+=(256-c[a])*(64-e)/64:128>=e?c[a]-=c[a]*(e-64)/64:e>128&&(c[a]=256-o/192*256),c[a]=Math.round(Math.min(c[a],255)),"true"==t&&(c[a]=r.fn.mColorPicker.decToHex(c[a]));return"true"==t?"#"+c.join(""):"rgb("+c.join(", ")+")"},r.fn.mColorPicker.setColor=function(o,e){return"true"==e?r.fn.mColorPicker.RGBtoHex(o):r.fn.mColorPicker.hexToRGB(o)},r.fn.mColorPicker.colorTest=function(r){return f.css("background-color",r),f.css("background-color")},r.fn.mColorPicker.decToHex=function(r){var o="0123456789ABCDEF";return r=parseInt(r),String(o.charAt(Math.floor(r/16)))+String(o.charAt(r-16*Math.floor(r/16)))},r.fn.mColorPicker.RGBtoHex=function(o){var e,t="#";if(o=o?o.toLowerCase():!1,!o)return"";if(C.test(o))return o.substr(0,7);if(h.test(o))return o.replace(m,"$1$1$2$2$3$3").substr(0,7);if(e=o.match(u)){for(var c=1;4>c;c++)t+=r.fn.mColorPicker.decToHex(e[c]);return t}return r.fn.mColorPicker.colorTest(o)},r.fn.mColorPicker.hexToRGB=function(o){return o=o?o.toLowerCase():!1,o?u.test(o)?o:h.test(o)?(C.test(o)||(o=o.replace(m,"$1$1$2$2$3$3")),"rgb("+parseInt(o.substr(1,2),16)+", "+parseInt(o.substr(3,2),16)+", "+parseInt(o.substr(5,2),16)+")"):r.fn.mColorPicker.colorTest(o):""},e=r.fn.mColorPicker.init,l.ready(function(){c=r("body"),r.fn.mColorPicker.events(),e.replace&&("function"==typeof r.fn.mDOMupdate?r("input").mDOMupdate(r.fn.mColorPicker.start):"function"==typeof r.fn.livequery?r("input").livequery(r.fn.mColorPicker.start):(r.fn.mColorPicker.start(),l.live("ajaxSuccess.mColorPicker",r.fn.mColorPicker.start)))})}(jQuery);