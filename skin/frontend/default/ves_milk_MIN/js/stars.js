var Stars=Class.create({_x:0,_y:0,initialize:function(t){this._initialized=!1,this.options={bindField:null,maxRating:5,container:null,imagePath:"images/",callback:null,actionURL:null,value:0,locked:!1},Object.extend(this.options,t),this.locked=this.options.locked?!0:!1,this._star_xoffsets={empty:50,full:16,half:19},this._starSrc=this.options.imagePath+"starsprite-ps.png";var i=new Image;i.src=this._starSrc,this._setStarSrc=this.options.imagePath+"starsprite.png";var i=new Image;i.src=this._setStarSrc,this.value=-1,this.stars=[],this._clicked=!1,this.options.container?(this._container=$(this.options.container),this.id=this._container.id):(this.id="starsContainer."+Math.random(0,1e5),this._container=new Element("span",{id:this.id}),$(this.options.bindField).insert({after:this._container})),this._display(),this.setValue(this.options.value),this._initialized=!0},_display:function(){for(var t=0;t<this.options.maxRating;t++){var i=new Element("img",{src:this.options.imagePath+"spacer.png",style:"cursor:pointer;height:15px;width:16px;",title:"Rate as "+(t+1)});i.setStyle({backgroundImage:"url("+(this.locked?this._starSrc:this._setStarSrc)+")",backgroundPosition:this._star_xoffsets.empty+"px 0"}),!this.locked&&i.observe("mouseover",this._starHover.bind(this)),!this.locked&&i.observe("click",this._starClick.bind(this)),!this.locked&&i.observe("mouseout",this._starClear.bind(this)),this.stars.push(i),this._container.insert(i)}},_starHover:function(t){if(!this.locked){t||(t=window.event);var i=t.findElement(),s=!1;this.stars.each(function(t){t.setStyle({backgroundPosition:(s?this._star_xoffsets.empty:this._star_xoffsets.full)+"px 0"}),t==i&&(s=!0)},this)}},_starClick:function(t){if(!this.locked){t||(t=window.event);var i=t.findElement();this._clicked=!0,this.stars.each(function(t,s){if(t==i)throw this.setValue(s+1),$break},this)}},_starClear:function(){if(!this.locked||!this._initialized){var t=!1;this.stars.each(function(i,s){s>this.value&&(t=!0),i.setStyle({backgroundPosition:(t?this.value+.5==s?this._star_xoffsets.half:this._star_xoffsets.empty:this._star_xoffsets.full)+"px 0"}),console.log(i)},this)}},setValue:function(t){var i=arguments.length>1?!!arguments[1]:!0;this.locked&&this._initialized||(this.value=t-1,this.options.bindField&&($(this.options.bindField).value=t),this._initialized&&i&&(this.options.actionURL?new Ajax.Request(this.options.actionURL+t,{onComplete:this.options.callback,method:"get"}):this.options.callback&&this.options.callback(t)),this._starClear())}});