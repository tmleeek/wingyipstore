window.Flex?(Flex.ImageEditor=Class.create(),Flex.ImageEditor.prototype={flex:null,filters:null,containerId:null,flexContainerId:null,container:null,initialize:function(e,t,i){this.containerId=e,this.container=$(e),this.container.controller=this,this.config=i,this.flexContainerId=this.containerId+"-flash",Element.insert(this.container,{bottom:'<div id="'+this.flexContainerId+'"></div>'}),this.flex=new Flex.Object({width:"1024",height:"786",src:t,wmode:"transparent"}),this.flex.onBridgeInit=this.handleBridgeInit.bind(this),this.flex.apply(this.flexContainerId)},getInnerElement:function(e){return $(this.containerId+"-"+e)},handleBridgeInit:function(){this.flex.getBridge().addEventListener("image_loaded",this.handleImageLoad.bind(this)),this.flex.getBridge().setImage(this.config.image)},handleImageLoad:function(){alert("image_loaded:"+this.config.image),this.hangleImageResize()},hangleImageResize:function(){var e=this.flex.getBridge().getSize();this.getInnerElement("width").value=e.width,this.getInnerElement("height").value=e.height},rotateCw:function(){this.flex.getBridge().rotateFw(),this.hangleImageResize()},rotateCCw:function(){this.flex.getBridge().rotateBw(),this.hangleImageResize()},resize:function(){this.flex.getBridge().resize(parseFloat(this.getInnerElement("width").value),parseFloat(this.getInnerElement("height").value))},getImage:function(){this.getInnerElement("b64").value=this.flex.getBridge().getBase64Image()}}):alert("Flex library not loaded");